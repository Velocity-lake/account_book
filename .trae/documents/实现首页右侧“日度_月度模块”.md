## 目标
- 在“首页总览”右侧新增一个可切换模块区，按“日度/月份”展示对应视图与明细。
- 保持现有顶部模式切换与期间导航逻辑，切换时右侧模块同步刷新。

## 现状与挂钩点
- 首页视图：`ui_dashboard.py:10-20`，模式按钮：`ui_dashboard.py:35-37`，期间下拉与上一/本/下一期：`ui_dashboard.py:38-46`。
- 数据来源：`storage.load_state()` 与交易结构解析：`utils.parse_datetime/format_amount/normalize_ttype`（`ui_dashboard.py:275-306` 已有聚合入口）。

## 布局改造（轻量）
- 在 `DashboardPage.build_ui()` 中，将现有内容包为左侧区域 `left_main`，新增右侧区域 `right_panel`，整体用 `ttk.Panedwindow(orient=tk.HORIZONTAL)` 承载：
  - 左侧放现有 KPI/柱状图/趋势/饼图/账户余额/最近记录（原先依次 `pack` 的内容移动进 `left_main`）。
  - 右侧固定宽度（如 360–420px），用于容纳“日度模块/月份模块”。
- 保持滚动条逻辑（`self.vcanvas`）对左侧主内容生效，右侧模块不随左侧滚动或独立滚动（根据实际体验微调）。

## 日度模块（DailyModule）
- 组件：`ttk.Frame`，嵌入 `right_panel`。
- 头部导航：
  - 居中显示当前“YYYY年MM月”；旁侧两个 `ttk.Combobox`（年份/月份）。
  - 左右箭头按钮切月（上一月/下一月）。
  - 切换时刷新日历与明细；文本格式严格为“YYYY年MM月”。
- 日历主体：
  - 表头固定“周一 … 周日”。
  - 生成当月网格（含前后月占位可留白或灰显），每格包含：
    - 日期数字（居中）。
    - 当日财务摘要两行（根据有无数据显示）：
      - 支出红色 `#FF0000`，格式 `-<金额>`。
      - 收入绿色 `#00FF00`，格式 `+<金额>`。
- 账单明细区域：
  - 采用 `ttk.Treeview(show='tree headings')` 分组：父节点为日期标题“MM月DD日 星期X”；子节点为：
    - 第一子行：总支出（显示 `支:<金额>`）。
    - 后续子行：每笔 `-金额 类别 描述`，按日期倒序；
  - 默认展示当月所有有交易日期，无需点格子即可展开；可后续增强为点击日期过滤。
- 数据处理：
  - 对 `_current_txs` 按天聚合（`period_range()` 已能给出开始/结束，参考 `render_dual_bars` 的“日度”分桶 `ui_dashboard.py:320-337`）。
  - 星期显示按 Python 周一=0 映射到“周一 … 周日”。

## 月度模块（MonthlyModule）
- 组件：`ttk.Frame`，嵌入 `right_panel`。
- 顶部标题：居左或居中显示“YYYY年”。
- 月度汇总网格：
  - 1–12 月，6 列栅格（行数自适应），每个月份单元包含：
    - 加粗月份名（如“11月”）。
    - 两行汇总：第一行总支出（红），第二行总收入（绿，可为 `0.0`）。
  - 点击某个月份单元格时，下方详细区域更新到该月交易明细。
- 月度详细区域：
  - 顶部加粗“支:<金额>”。
  - 列表按日期倒序，列含：金额（负红/正绿）、类别、日期（`YYYY-MM-DD`）、描述。
  - 若该月无交易，显示“无数据”。
- 数据处理：
  - 依照 `render_dual_bars` 的“月份”分桶实现（`ui_dashboard.py:337-351`），并统计收入/支出。

## 集成与事件流
- `DashboardPage.on_mode_change()`：除现有 `fill_periods()`/`current_period()` 外，调用 `show_right_module()` 按 `self.mode` 切换右侧模块实例与内容（`ui_dashboard.py:148-152`）。
- `DashboardPage.compute_and_render()`：在更新 `_current_txs` 与图表后，调用当前右侧模块的 `refresh(period, txs)`，以保持数据与期间一致。
- 期间切换（上一/本/下一期）沿用现有逻辑（`ui_dashboard.py:230-274`），右侧模块根据 `self.period.get()` 联动更新。

## 颜色与样式
- 红色 `#FF0000`（支出），绿色 `#00FF00`（收入），严格按需求应用到文本与数值显示。
- 字体与控件样式沿用主题：`theme.setup_theme(root)`；优先使用 `ttk` 控件，图形绘制用 `tk.Canvas`。

## 代码位置与组织
- 为减少新文件，引入 `DailyModule` 与 `MonthlyModule` 类到 `ui_dashboard.py`（靠后添加类定义与工具函数）。
- 公共聚合函数（每日/每月统计、日期分组）也置于 `ui_dashboard.py`，复用 `utils` 的格式化函数。

## 验证与性能
- 用现有示例数据（`storage.load_state()` 的 `transactions`）进行：
  - 切换“日度/月份”按钮验证右侧模块显示与刷新。
  - 箭头/下拉切换月份与年份，日历与明细同步。
  - 点击“月份汇总”单元格联动详细区域。
- 渲染规模：月历最大 6×7=42 格；Treeview 分组按日期创建父节点，数据量较大时仍可流畅（必要时加懒加载）。

## 边界与后续可选增强
- 日历格点击联动下方明细过滤（当前默认展示所有有交易日期）。
- 无交易日保持摘要为空白；跨月空格灰显以便区分。
- 与现有图表点击弹出 `BillListDialog` 的行为兼容（`ui_dashboard.py:428-456`、`595-635`）。

## 交付
- 修改 `ui_dashboard.py`（不新增文件），新增右侧模块与事件联动。
- 不改动数据结构与持久化；仅调用现有 `load_state()` 等工具函数。