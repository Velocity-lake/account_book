## 当前行为与定位
- 单条编辑入口：`ui_bill_list.py:554` 的 `on_edit` 右键“编辑”处理。当前流程：获取选中记录→打开 `AddTransactionDialog`→撤销旧资产→`update_transaction`→应用新资产→`save_state`→刷新（`ui_bill_list.py:554-569`）。
- 未新增类别原因：`on_edit` 未在保存前调用 `add_category`，因此当用户在对话框中输入了一个全新的“消费类别”时，类别清单不更新（对比批量修改里已调用 `add_category`，见 `ui_bill_list.py:887`）。
- 类别数据源：`storage.py:281-286` 的 `add_category` 会把新类别写入 `state["categories"][scene]`；筛选与类别网格均从存储加载（例如账单列表批量修改用 `get_categories(load_state(), sc)`，见 `ui_bill_list.py:858-865`；记录页类别网格见 `ui_record_page.py:111-121`）。

## 修改方案
- 在 `on_edit` 保存前，根据新记录的 `ttype` 归一化为场景（收入/支出），将用户输入的 `category` 写入类别表：
  ```python
  # ui_bill_list.py:564 之后插入（在 update_transaction 前）
  typ = normalize_ttype(new.get("ttype"))
  if typ in ["收入","报销类收入","支出","报销类支出"]:
      scene = "收入" if typ in ["收入","报销类收入"] else "支出"
      cat = (new.get("category") or "").strip()
      if cat:
          add_category(self.state, scene, cat)
  ```
- 保持现有资产差异处理与刷新逻辑不变（`apply_transaction_delta`、`update_transaction`、`save_state`、`reapply_last_filters`）。
- 跳过非分类场景：编辑为“转账/还款”时不新增类别，以避免将“转账”等写入消费类别清单。

## 验证用例
- 用例1：选中一条“支出”记录右键编辑，输入新类别“咖啡”，保存后：
  - 记录页支出类别网格中出现“咖啡”（`ui_record_page.py:111-121` 读自存储）。
  - 账单列表“批量修改消费类别”选择支出时下拉包含“咖啡”（`ui_bill_list.py:858-865`）。
- 用例2：编辑为“转账”，输入类别“转账X”，保存后不新增类别（符合跳过逻辑）。
- 用例3：输入已有类别名称，`add_category` 会去重，不会重复添加（`storage.py:281-286`）。

## 兼容性与影响
- 复用已存在的 `normalize_ttype`（`utils.py:37-46`）与 `add_category`；无需新增数据结构或 UI 改动。
- 与导入/AI预填时的类别同步逻辑保持一致（参考 `ui_bill_list.py:652-672`）。

确认后我将按上方片段在 `on_edit` 中插入调用，并进行上述用例验证。