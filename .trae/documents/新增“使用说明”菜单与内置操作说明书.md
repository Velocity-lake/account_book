## 目标
- 增加一级菜单“使用说明”，点击后在右侧内容区显示一个类似 Word 的说明文档，并带有可点击的章节目录（TOC）。
- 首版完整《操作说明书》按“一级菜单 → 二级菜单 → 功能点”的结构编写并内置展示。
- 建立后续维护机制：当功能点更新时，同步更新说明书内容。

## 现有架构位置
- 应用为 Python + Tkinter/ttk 桌面端，入口：`app.py`。
- 左侧菜单与右侧内容区定义：`ui_main.py`。
  - 侧边栏构建：`MainApp.build_sidebar()`（新增“使用说明”按钮）
  - 页面注册与切换：`MainApp.build_ui()` 的 `self.pages` 字典（新增 `HelpPage` 并实现 `show_help()`）
- 已有页面键：`dashboard`、`bills`、`accounts`、`record`、`settings`、`import` 等。

## 技术实现方案
- 新增页面：`HelpPage(ttk.Frame)`
  - 布局：右侧内容区内使用水平分栏（`ttk.PanedWindow` 或两个 `ttk.Frame`）
    - 左侧：`ttk.Treeview` 构建章节目录（支持多级），点击目录项时滚动文档到对应锚点。
    - 右侧：`tk.Text` 展示正文，使用 `tag_configure` 区分 H1/H2/H3、代码、引用等样式，并为每个章节创建锚点（`text.mark_set`/`text.index`）。
  - 数据：将说明书内容维护为结构化数据（Python 列表/字典），包含 `title`、`level`、`content`、`children`。渲染时：
    - 递归生成 TOC；
    - 顺序写入 `Text`，记录每个章节的起始索引，存入映射（TOC 节点 ID → 文本索引）。
  - 交互：
    - 点击 TOC 节点：通过 `text.see(index)` + `text.mark_set("insert", index)` 定位；
    - 支持 Ctrl+F 简单查找（可选）。
- 集成：
  - `ui_main.py` 的 `self.pages['help'] = HelpPage(self.content)`；
  - `build_sidebar()` 新增 `“使用说明”` 按钮，绑定到 `show_help()`；
  - `show_help()` 与其他 `show_xxx()` 一致地 `pack_forget()/pack()` 切换，并可调用 `HelpPage.refresh()`。

## 首版《操作说明书》
以下为内置在应用中的首版内容（后续可继续扩展）：

### 1. 概述
- 目的：帮助用户高效完成记账、账单管理、账户管理与数据导入等工作。
- 界面结构：左侧为一级菜单，右侧为对应功能页面；支持页面右键菜单与常用筛选。
- 术语约定：
  - “记录”：一条收支交易；
  - “账户”：资金归属载体（现金、银行卡、电子钱包等）；
  - “账单”：一组或列表化的记录集合。

### 2. 快速上手
- 安装与启动：双击启动程序或运行 `app.py`。
- 初始化：在“设置”中检查偏好（币种、日期格式等），在“账户管理”创建至少一个账户。
- 首次记账：进入“记账”，填写金额、类别、账户、备注并保存。

### 3. 一级菜单与功能

#### 3.1 首页总览（Dashboard）
- 功能点：
  - 总览信息：近期收支汇总、趋势概览、关键指标；
  - 交易表：最近记录列表，支持简单筛选（时间区间、账户等）；
  - 右键菜单：在表格或卡片处打开上下文操作（如查看详情）。
- 操作路径：左侧“首页总览”→ 右侧查看与筛选。

#### 3.2 记账（Record）
- 功能点：
  - 新增记录：金额（收入/支出）、类别、账户、日期、备注；
  - 编辑/删除：在记录表或编辑面板中修改或移除；
  - 校验与提示：必填项缺失时提示；
  - 快捷键（示例）：Enter 保存、Esc 取消（以实际界面为准）。
- 操作路径：左侧“记账”→ 填写 → 保存。

#### 3.3 账单列表（Bills）
- 功能点：
  - 列表浏览：支持排序与分页（若有）；
  - 筛选与搜索：按时间、账户、类别过滤；
  - 右键菜单：查看详情、跳转编辑、删除（以实际界面为准）。
- 操作路径：左侧“账单列表”→ 条件筛选 → 右键或双击操作。

#### 3.4 账户管理（Accounts）
- 功能点：
  - 账户树：分层展示账户与子账户；
  - 新增/编辑/删除账户：通过工具栏或右键菜单；
  - 启用/停用：控制可用状态；
  - 余额相关：设置期初余额或调整（如页面支持）。
- 操作路径：左侧“账户管理”→ 树节点右键或按钮操作。

#### 3.5 数据导入（Import）
- 功能点：
  - 文件导入：从文件导入账单数据（具体支持格式以界面显示为准，如 CSV/Excel）；
  - 字段映射：将外部字段映射到本系统的“金额/日期/账户/类别/备注”等；
  - 预览与校验：导入前预览、重复/缺失检测、错误定位；
  - 导入结果：成功与失败条目统计与反馈。
- 操作路径：左侧“导入”→ 选择文件 → 字段映射 → 预览 → 导入。

#### 3.6 设置（Settings）
- 功能点（依界面而定）：
  - 基础偏好：货币、日期格式、语言等；
  - 类别与标签：管理收支类别与标签（如有）；
  - 显示与主题：表格列、主题风格（如有）。
- 操作路径：左侧“设置”→ 按需修改 → 保存。

#### 3.7 使用说明（Help）
- 功能点：
  - 章节目录（TOC）：左侧树形目录，点击定位到右侧正文；
  - 文本浏览：支持标题层级、段落、代码块/引用样式；
  - 查找（可选）：在正文中按关键字查找。
- 操作路径：左侧“使用说明”→ 点击目录 → 阅读正文。

### 4. 常见问题（FAQ）
- 导入失败：检查文件格式与字段映射是否正确；
- 记录不显示：确认筛选条件与时间范围；
- 账户余额异常：核对期初余额与记录方向（收入/支出）。

### 5. 键盘快捷键（示例，具体以界面为准）
- 全局：Ctrl+F 查找；
- 记账：Enter 保存、Esc 取消；
- 列表：Ctrl+L 聚焦筛选框、Delete 删除选中。

### 6. 数据与备份（如实现）
- 导出/备份：在设置或列表页提供数据导出；
- 恢复：从备份文件恢复。

### 7. 版本与更新
- 每次功能变更均会同步更新本说明书对应章节与操作路径。

## 维护与同步更新机制
- 内容集中维护：新增 `help_content.py`（或 `ui_help.py` 内部结构化数据），由我们统一维护章节与正文。
- 开发流程钩子：
  - 新增/修改功能点时，同时更新对应章节；
  - 侧边栏、页面键或路由变更时，校对“一级菜单 → 二级菜单 → 功能点”的章节结构。
- 审核：提交前自测 Help 页面目录跳转与正文渲染；版本发布前进行一次通读校对。

## 验证计划
- 启动应用，点击“使用说明”菜单，确认：
  - TOC 能展示多级章节，点击能定位到正文对应位置；
  - 正文标题/段落样式正确，滚动与查找正常；
  - 切换页面后返回“使用说明”仍能保留滚动位置（可选）。

## 交付与后续
- 获得确认后，实施代码改动并提交；
- 后续每次功能变更，我将同步更新说明书内容并回传变更摘要，以便您审阅。