## 目标与范围
- 在“账户管理”页新增：导出账户为 `.xlsx`、导入账户 `.xlsx`、下载账户标准模板。
- 支持批量新增与批量修改；可选“全量覆盖模式”（导入文件为准，不在文件中的账户将被移除）。
- 不引入第三方库，复用现有自写 `.xlsx` 读写能力与存储接口。

## 标准格式（xlsx 单表）
- Sheet 名：`accounts`
- 表头（第1行）：`名称`、`类型`、`余额`、`备注`
- 数据规则：
  - `名称`：必填，作为主键；重复名称只保留最后一行。
  - `类型`：可为空；若为新类型，自动加入 `state.account_types`。
  - `余额`：数字；导入时默认以导入值为准覆盖现有余额。
  - `备注`：可为空。
- 模板下载：生成仅含表头的空文件，方便用户批量填充。

## 导出实现
- 位置：账户管理页新增“导出账户”按钮（`ui_account_manager.py`）。
- 数据来源：`storage.load_state()` 的 `state['accounts']`（`storage.py:51–86`）。
- 写出：复用 `ui_main._write_xlsx(path, header, rows)`（`ui_main.py:328–397`），按标准表头输出每个账户的 `name/type/balance/note`。
- 文件命名：`accounts_YYYYMMDD_HHMMSS.xlsx`，用户可自选保存路径。

## 导入实现
- 入口：账户管理页新增“导入账户”按钮（`ui_account_manager.py`）。
- 读取：优先使用 `xlsx_reader.read_xlsx(path)`（`xlsx_reader.py:27–99`），解析成行列表；兼容 CSV 作为备选（已有 `importers.read_csv`）。
- 解析：映射到 `{name, type, balance, note}` 结构；空行与无效行跳过。
- 应用：
  - 为每个 `name` 执行 upsert：存在则覆盖 `type/balance/note`，不存在则 `add_account`（`storage.py:92–137`）。
  - `type` 不在 `state['account_types']` 时自动追加；`balance` 解析失败记录为错误行。
  - 统计并提示：新增数、更新数、错误数。
- 保存：调用 `save_state(state)`（`storage.py:51–86`）。

## 覆盖策略（两种）
- 增量覆盖（默认）：按 `name` upsert，不处理未出现在导入文件中的账户。
- 全量覆盖（可选勾选）：导入成功后将现有 `accounts` 替换为导入集合；未在文件中的账户被移除。
  - 风险提示：移除账户不会自动删除历史交易；与交易引用一致性由用户确认。

## UI改动点
- `ui_account_manager.py`：新增顶部/右键菜单项与事件回调（参考已实现的“新增/删除/编辑”，如 `ui_account_manager.py:184–207, 209–231`）。
- 成功与错误弹窗：延用已有提示样式与统计汇总（参考导入结果统计 `ui_main.py:265–288`）。
- 模板下载按钮：调用统一的模板生成函数（复用 `_write_xlsx`）。

## 校验与错误处理
- 表头校验：缺失或错序时提示并拒绝导入（提供示例表头）。
- 数据校验：`name` 为空、`balance` 非数字、重复行处理策略（保留最后一行）。
- 账户类型：未知类型自动加入；提供开关以仅限已知类型。
- 事务一致性：余额覆盖为显式策略，弹窗确认（“以导入余额为准”）。

## 备份与回滚
- 导入前自动执行 `backup_state()`（`storage.py:51–86`），在 `data/backups/ledger_*.json` 留存。
- 导入失败或用户取消时不写入；导入后如需回滚，提示备份位置。

## 测试与验证
- 人工用例：
  - 新增账户：仅一行新名称 → 导入后列表出现。
  - 修改账户：已有账户修改 `type/balance/note` → 导入后被覆盖。
  - 错误行：空名称、非数字余额 → 统计显示错误数并跳过。
  - 全量覆盖：文件只含两个账户 → 导入后，仅保留这两个账户。
- 文件兼容：同一模板生成/读取回环验证；CSV 备用读取验证。

## 兼容性与依赖
- 依托现有 GUI 与存储：`app.py:1–15`、`storage.py:51–86`、`models.py:1–46`。
- 读写 `.xlsx` 不引入第三方库，沿用 `zipfile+xml` 方案（`ui_main._write_xlsx`、`ui_bill_list._write_xlsx:1278–1297`）。
- 不更改现有导入交易流程（`importers.try_import:211–266`），仅新增账户导入逻辑与UI入口。

请确认以上方案，我将按此实现并进行完整验证。