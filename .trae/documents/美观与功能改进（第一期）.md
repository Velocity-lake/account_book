## 总体建议
- 美观：统一字体与间距、可切换浅色/深色主题、图表配色与标签对比度优化、状态颜色（收入/支出/转账）一致化。
- 功能：常用类别快捷选取、账单筛选方案保存/一键应用、全局快捷键、仪表盘交互（点击图表联动到清单已具备，补充导出/记忆上次视图）。
- 性能与易用：减少重复解析日期、在账单列表中预排序后再插入（已实现），补充筛选预设与列宽记忆。

## 本次实施范围
1) 深色主题切换与主题持久化
2) 账单筛选方案保存/应用
3) 全局快捷键（快速打开常用页面与操作）
4) 记账页“常用类别”快捷区

## 技术实现
### 1. 深色主题切换
- 修改 `theme.py`：在 `setup_theme(root)` 基础上增加主题参数与深色配色（`TLabel`、`Sidebar.TButton`、`Primary.TButton`、`Treeview`/`Heading`）。
- 新增偏好项 `prefs.theme`，默认 `light`（`storage.py` 读取/填充）。
- 在 `app.py:6-12` 读取 `prefs.theme` 后传给 `setup_theme`。入口保持无外部依赖。
- 在设置页 `ui_settings.py` 增加“主题”分组，提供“浅色/深色”单选，更新偏好并立即应用到当前 `root`。

### 2. 账单筛选方案保存/应用
- 在 `ui_bill_list.py` 顶部工具条新增两个按钮：“保存方案”“应用方案”。
- 将当前筛选状态写入 `prefs.bill_list.presets`（名称+过滤条件字段，使用现有 `last_filters` 字段结构）。
- “应用方案”弹出下拉/列表选择预设，选中后写回各控件并调用 `apply_filter()`。
- 数据结构示例：`state.prefs.bill_list.presets = [{name:"近30天支出>100", filters:{...}}]`。

### 3. 全局快捷键
- 在主框架 `ui_main.py` 绑定：
  - `Ctrl+B` 账单列表，`Ctrl+D` 首页总览，`Ctrl+R` 记录账单，`Ctrl+I` 导入面板，`F5` 刷新数据，`Ctrl+F` 聚焦账单列表搜索框。
- 焦点跳转：当页面为账单列表时，`Ctrl+F` 将焦点置于 `self.e_search`（`ui_bill_list.py`）。

### 4. 记账页“常用类别”快捷区
- 在 `ui_record_page.py` `build_category_grid` 之前渲染一行“最近使用”按钮（取当前场景最近 N 条交易的类别，去重后展示 6 个）。
- 点击快捷按钮直接选择类别并高亮，沿用现有 `select_category` 方法。

## 代码位置与改动点
- 入口与主题：`app.py:5-12`、`theme.py:3-17` 扩展接口与样式映射。
- 设置页：`ui_settings.py:23-66` 旁新增“主题”LabelFrame、事件处理 `on_theme_change`（复用 `save_state`）。
- 账单列表：`ui_bill_list.py:21-93` 工具条加两个按钮及保存/应用逻辑；利用现有 `last_filters` 与 `apply_filter`。
- 主框架快捷键：`ui_main.py:37-64` 初始化后绑定 `bind_all`；页面切换函数复用现有 `show_*` 方法。
- 记账页快捷区：`ui_record_page.py:181-267` 附近插入“最近使用”区域与数据聚合（按 `parse_datetime(time)` 倒序）。

## 验收标准
- 设置页切换主题后，所有页面字体/按钮/表格颜色即时变化且保持对比度可读。
- 能保存至少 3 个筛选预设并一键应用，无报错；预设持久化到 `data/ledger.json`。
- 快捷键在任意页面有效，且不会与文本输入冲突（在输入框中按 `Ctrl+B` 不触发导航）。
- 记账页顶部出现“最近使用”类别，点击可选中并保存账单。

## 备选下一步
- 图表导出（Canvas `postscript` 保存为图片）、仪表盘记忆上次视图并开机恢复、筛选预设的管理（重命名/删除）。

请确认以上计划，确认后我将开始改动并完成实现与自测。