## 目标
- 在记账页优雅地选择两级分类：无二级直接点选；有二级以“一级/二级”完成选择，并尽量减少点击与眼动。

## UX 备选方案
- 级联弹窗选择器（推荐）：点击含子项的一级后，弹出靠近点击位置的 Toplevel，两栏布局：左栏选一级，右栏即时显示二级；支持键盘输入过滤，最近使用置顶；Enter 确认，Esc 关闭。
- 就地展开：一级按钮下就地展开二级 Chips，再次点击或点击其他一级自动折叠；适合触控但占用空间较多。
- 双下拉：一级 Combobox + 二级 Combobox，键盘友好、实现简单，但与当前“网格按钮”风格不一致。

## 推荐实现：级联弹窗选择器
- 触发逻辑：
  - 在 `ui_record_page.py:186 build_category_grid` 中分组类别（`get_categories(state, sc)`），对含 `'/'` 的名称派生 `{major: [minor...]}`。
  - 点击无子项的一级：直接选择 `category=major` 并关闭层。
  - 点击有子项的一级：调用 `open_minor_picker(major)` 弹出层。
- 弹窗结构：
  - 使用 `tk.Toplevel`（无边框或细边框），位置锚定在点击按钮附近。
  - 左侧 `tk.Listbox` 展示所有一级（含高亮当前项）；右侧为二级按钮网格（`ttk.Button`）。
  - 顶部 `ttk.Entry` 用于实时过滤（对一级和二级同时过滤）。
  - 底部“最近使用”一行，来自 `_render_quick_categories` 的数据（`ui_record_page.py:272`），点击后直接选择完整字符串。
- 交互细节：
  - 键盘：↑↓ 切一级，Tab 切到二级区，Enter 选中，Esc 关闭。
  - 鼠标：单击即选中；点击弹窗外区域关闭。
  - 选择后调用现有 `self.select_category(name)`（`ui_record_page.py:230`）写入 `category`；二级选择时 `name = f"{major}/{minor}"`。

## 数据与解析
- 继续使用字符串保存类别（`category` 为 `一级` 或 `一级/二级`）。
- 解析工具：新增 `split_category(name)` 与 `join_category(major, minor)`（置于 `storage.py`，与 `get_categories` 相邻，参考 `storage.py:491-505`）。
- 历史兼容：在 `storage.py:131-136` 读取 JSON 时，如同时存在 `major_category` 与 `minor_category`，合成为 `category = f"{major}/{minor}"`，仅有其一则用其一。

## 统计与列表
- 看板饼图维持按完整 `category` 聚合（`ui_dashboard.py:945-957`）；可选增加“按一级聚合”切换，使用 `split_category(cat)[0]`。
- 列表显示不变（`ui_bill_list.py:400` 映射 `category`）；新增/编辑与批量修改处用两级选择合成字符串（参考 `ui_bill_list.py:772,806,1256-1292`）。

## 验证
- 构造示例类别：`餐饮/早餐`、`餐饮/晚餐`、`工资`。
- 验证录入页两栏弹窗选择流程、最近使用、过滤与键盘操作；列表展示与饼图聚合正常。